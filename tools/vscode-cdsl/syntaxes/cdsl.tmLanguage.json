{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "_generator": "Generated by gen-textmate. Do not edit manually.",
  "fileTypes": [
    "cdsl"
  ],
  "name": "Continuum DSL",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#top-level-items"
    },
    {
      "include": "#expressions"
    }
  ],
  "repository": {
    "attributes": {
      "patterns": [
        {
          "captures": {
            "1": {
              "name": "punctuation.separator.cdsl"
            },
            "2": {
              "name": "support.type.cdsl"
            }
          },
          "match": "(:)\\s*(Scalar|Vector|Tensor|Map|sphere_surface|point_cloud|volume|symmetric|positive_definite)\\b"
        },
        {
          "captures": {
            "1": {
              "name": "punctuation.separator.cdsl"
            },
            "2": {
              "name": "keyword.attribute.cdsl"
            },
            "3": {
              "name": "punctuation.parenthesis.open.cdsl"
            }
          },
          "match": "(:)\\s*(strata|topology|title|symbol|uses|phase|era|stride|active|converge|warmup|iterate|gated)\\s*(\\()"
        },
        {
          "captures": {
            "1": {
              "name": "punctuation.separator.cdsl"
            },
            "2": {
              "name": "keyword.attribute.cdsl"
            }
          },
          "match": "(:)\\s*(initial|terminal)\\b"
        }
      ]
    },
    "block-keywords": {
      "match": "\\b(resolve|measure|when|emit|assert|collect|on|config|initial|terminal|transition)\\b",
      "name": "keyword.control.block.cdsl"
    },
    "chronicle-def": {
      "begin": "\\b(chronicle)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.chronicle.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "comments": {
      "patterns": [
        {
          "match": "///.*$",
          "name": "comment.line.documentation.cdsl"
        },
        {
          "match": "//!.*$",
          "name": "comment.line.module-documentation.cdsl"
        },
        {
          "match": "//.*$",
          "name": "comment.line.double-slash.cdsl"
        },
        {
          "match": "#.*$",
          "name": "comment.line.hash.cdsl"
        },
        {
          "begin": "/\\*",
          "captures": {
            "0": {
              "name": "punctuation.definition.comment.cdsl"
            }
          },
          "end": "\\*/",
          "name": "comment.block.cdsl"
        }
      ]
    },
    "config-block": {
      "begin": "\\b(config)\\s*\\{",
      "beginCaptures": {
        "1": {
          "name": "keyword.other.config.cdsl"
        }
      },
      "end": "\\}",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#config-entry"
        }
      ]
    },
    "config-entry": {
      "captures": {
        "1": {
          "name": "variable.other.config.cdsl"
        },
        "2": {
          "name": "punctuation.separator.cdsl"
        },
        "3": {
          "patterns": [
            {
              "include": "#literals"
            }
          ]
        }
      },
      "match": "([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)*)\\s*(:)\\s*([^\\n#/]+)"
    },
    "const-block": {
      "begin": "\\b(const)\\s*\\{",
      "beginCaptures": {
        "1": {
          "name": "keyword.other.const.cdsl"
        }
      },
      "end": "\\}",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#const-entry"
        }
      ]
    },
    "const-entry": {
      "captures": {
        "1": {
          "name": "variable.other.constant.cdsl"
        },
        "2": {
          "name": "punctuation.separator.cdsl"
        },
        "3": {
          "patterns": [
            {
              "include": "#literals"
            }
          ]
        }
      },
      "match": "([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)*)\\s*(:)\\s*([^\\n#/]+)"
    },
    "definition-body": {
      "begin": "\\{",
      "beginCaptures": {
        "0": {
          "name": "punctuation.brace.open.cdsl"
        }
      },
      "end": "\\}",
      "endCaptures": {
        "0": {
          "name": "punctuation.brace.close.cdsl"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#block-keywords"
        },
        {
          "include": "#attributes"
        },
        {
          "include": "#inner-blocks"
        },
        {
          "include": "#expressions"
        }
      ]
    },
    "definition-name": {
      "captures": {
        "1": {
          "name": "entity.name.cdsl"
        }
      },
      "match": "([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)*)"
    },
    "entity-def": {
      "begin": "\\b(entity)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.entity.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "era-def": {
      "begin": "\\b(era)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.era.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "expressions": {
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#keywords"
        },
        {
          "include": "#operators"
        },
        {
          "include": "#references"
        },
        {
          "include": "#function-calls"
        },
        {
          "include": "#literals"
        },
        {
          "include": "#identifiers"
        }
      ]
    },
    "field-def": {
      "begin": "\\b(field)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.field.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "fn-def": {
      "begin": "\\b(fn)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.function.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#fn-name-and-params"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "fn-name-and-params": {
      "begin": "([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)*)\\s*(\\()",
      "beginCaptures": {
        "1": {
          "name": "entity.name.function.cdsl"
        },
        "2": {
          "name": "punctuation.parenthesis.open.cdsl"
        }
      },
      "end": "(\\))",
      "endCaptures": {
        "1": {
          "name": "punctuation.parenthesis.close.cdsl"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "match": "([a-zA-Z_][a-zA-Z0-9_]*)",
          "name": "variable.parameter.cdsl"
        },
        {
          "match": ",",
          "name": "punctuation.separator.cdsl"
        }
      ]
    },
    "fracture-def": {
      "begin": "\\b(fracture)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.fracture.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "function-calls": {
      "patterns": [
        {
          "captures": {
            "1": {
              "name": "entity.name.function.call.cdsl"
            }
          },
          "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)*)\\s*(?=\\()"
        }
      ]
    },
    "identifiers": {
      "match": "\\b[a-zA-Z_][a-zA-Z0-9_]*\\b",
      "name": "variable.other.cdsl"
    },
    "impulse-def": {
      "begin": "\\b(impulse)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.impulse.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "inner-blocks": {
      "begin": "\\b(resolve|measure|when|emit|assert|collect|config|transition)\\s*\\{",
      "beginCaptures": {
        "1": {
          "name": "keyword.control.block.cdsl"
        }
      },
      "end": "\\}",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#expressions"
        },
        {
          "include": "#inner-blocks"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "match": "\\b(if|else|let|in|for)\\b",
          "name": "keyword.control.cdsl"
        },
        {
          "match": "\\b(prev|dt_raw|collected|payload)\\b",
          "name": "variable.language.cdsl"
        },
        {
          "match": "\\b(self)\\b",
          "name": "variable.language.self.cdsl"
        },
        {
          "match": "\\b(and|or|not)\\b",
          "name": "keyword.operator.logical.cdsl"
        },
        {
          "match": "\\b(sum|count|product|min|max|mean|any|all|none)\\b",
          "name": "keyword.operator.aggregate.cdsl"
        },
        {
          "match": "\\b(other|pairs|filter|first|nearest|within|each)\\b",
          "name": "keyword.operator.entity.cdsl"
        },
        {
          "match": "\\b(PI|TAU|PHI|E|I)\\b|[πτφℯⅈ]",
          "name": "constant.language.math.cdsl"
        },
        {
          "match": "\\b(warn|error|halt|fatal)\\b",
          "name": "keyword.other.severity.cdsl"
        }
      ]
    },
    "literals": {
      "patterns": [
        {
          "begin": "\"",
          "end": "\"",
          "name": "string.quoted.double.cdsl",
          "patterns": [
            {
              "match": "\\\\.",
              "name": "constant.character.escape.cdsl"
            }
          ]
        },
        {
          "match": "-?\\d+\\.\\d+([eE][+-]?\\d+)?",
          "name": "constant.numeric.float.cdsl"
        },
        {
          "match": "-?\\d+[eE][+-]?\\d+",
          "name": "constant.numeric.float.scientific.cdsl"
        },
        {
          "match": "-?\\d+",
          "name": "constant.numeric.integer.cdsl"
        },
        {
          "comment": "Unit annotation like <K>, <W/m²>, <kg/s> - no spaces allowed inside",
          "match": "<[a-zA-Z0-9/·°⁰¹²³⁴⁵⁶⁷⁸⁹⁻⁺_-]+>",
          "name": "support.type.unit.cdsl"
        }
      ]
    },
    "member-def": {
      "begin": "\\b(member)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.member.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "operator-def": {
      "begin": "\\b(operator)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.operator.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "match": "<-",
          "name": "keyword.operator.assignment.cdsl"
        },
        {
          "match": "==|!=|<=|>=|<|>",
          "name": "keyword.operator.comparison.cdsl"
        },
        {
          "match": "&&|\\|\\|",
          "name": "keyword.operator.logical.cdsl"
        },
        {
          "match": "\\+|-|\\*|/|%|\\^",
          "name": "keyword.operator.arithmetic.cdsl"
        },
        {
          "match": "!",
          "name": "keyword.operator.logical.not.cdsl"
        },
        {
          "match": "\\.\\.",
          "name": "keyword.operator.range.cdsl"
        }
      ]
    },
    "references": {
      "patterns": [
        {
          "captures": {
            "1": {
              "name": "keyword.other.reference.signal.cdsl"
            },
            "2": {
              "name": "punctuation.accessor.cdsl"
            }
          },
          "match": "\\b(signal)(\\.)"
        },
        {
          "captures": {
            "1": {
              "name": "keyword.other.reference.const.cdsl"
            },
            "2": {
              "name": "punctuation.accessor.cdsl"
            }
          },
          "match": "\\b(const)(\\.)"
        },
        {
          "captures": {
            "1": {
              "name": "keyword.other.reference.config.cdsl"
            },
            "2": {
              "name": "punctuation.accessor.cdsl"
            }
          },
          "match": "\\b(config)(\\.)"
        },
        {
          "captures": {
            "1": {
              "name": "keyword.other.reference.field.cdsl"
            },
            "2": {
              "name": "punctuation.accessor.cdsl"
            }
          },
          "match": "\\b(field)(\\.)"
        },
        {
          "captures": {
            "1": {
              "name": "keyword.other.reference.entity.cdsl"
            },
            "2": {
              "name": "punctuation.accessor.cdsl"
            }
          },
          "match": "\\b(entity)(\\.)"
        }
      ]
    },
    "signal-def": {
      "begin": "\\b(signal)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.signal.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "strata-def": {
      "begin": "\\b(strata)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.strata.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "top-level-items": {
      "patterns": [
        {
          "include": "#const-block"
        },
        {
          "include": "#config-block"
        },
        {
          "include": "#signal-def"
        },
        {
          "include": "#field-def"
        },
        {
          "include": "#operator-def"
        },
        {
          "include": "#fracture-def"
        },
        {
          "include": "#impulse-def"
        },
        {
          "include": "#chronicle-def"
        },
        {
          "include": "#entity-def"
        },
        {
          "include": "#member-def"
        },
        {
          "include": "#strata-def"
        },
        {
          "include": "#era-def"
        },
        {
          "include": "#type-def"
        },
        {
          "include": "#fn-def"
        },
        {
          "include": "#world-def"
        }
      ]
    },
    "type-def": {
      "begin": "\\b(type)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.type.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    },
    "world-def": {
      "begin": "\\b(world)\\s+",
      "beginCaptures": {
        "1": {
          "name": "keyword.declaration.world.cdsl"
        }
      },
      "end": "(?=\\bsignal\\b|\\bfield\\b|\\boperator\\b|\\bfracture\\b|\\bimpulse\\b|\\bchronicle\\b|\\bentity\\b|\\bmember\\b|\\bstrata\\b|\\bera\\b|\\btype\\b|\\bfn\\b|\\bworld\\b|\\bconst\\b|\\bconfig\\b|$(?!\\n))",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#definition-name"
        },
        {
          "include": "#definition-body"
        }
      ]
    }
  },
  "scopeName": "source.cdsl"
}